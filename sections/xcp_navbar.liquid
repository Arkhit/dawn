{{ 'xcp_navbar.css' | asset_url | stylesheet_tag }}
{% assign nav_items = section.blocks | where: 'type', 'xcp-nav-item' %}
{%- assign schedule_call_block =  section.blocks | where: 'type', 'xcp-nav-schedule-a-call' | first -%}
{%- assign order_now_block =  section.blocks | where: 'type', 'xcp-nav-order-now' | first -%}

<div class="xcp-navbar__container" data-target="xcp-navbar">
  <nav class="xcp-navbar xcp-navbar__desktop">
    <span class="xcp-navbar__xcp-logo">
      <a href="/technologies/x-carve-pro">
        <span class='xcp-navbar__xcp-logo--x-carve'>X-CARVE </span>Pro
      </a>
    </span>

    <div>
      <ul class="xcp-navbar__menu--desktop">
        {% for nav_item in nav_items %}
          <li class="xcp-navbar__menu-item--desktop">
            {%- if nav_item.settings.selected -%}
              <span class="current-page">{{nav_item.settings.label}}</span>
            {%- else -%}
              <a href="{{nav_item.settings.href}}">{{nav_item.settings.label}}</a>
            {%- endif -%}
          </li>
        {% endfor %}

        {%- if schedule_call_block -%}
          <li>
            <button name="button" type="submit" class="btn btn-primary xcp-navbar__schedule-demo xcp-modal xcp-nav-schedule-a-call" data-target="calendly-modal-trigger" data-modal-target="xcp-demo__modal" data-modal-target-closed="xcp-demo__modal--closed" data-modal-closer="xcp-demo__modal-close">Schedule A Call</button>
          </li>
        {%- endif -%}
        {%- if order_now_block -%}
          {% render 'xcp-order-now', settings: order_now_block.settings, submit_label: order_now_block.settings.label %}
        {%- endif -%}
      </ul>
    </div>
  </nav>

  <nav class="xcp-navbar xcp-navbar__mobile">
    <span class="xcp-navbar__xcp-logo">
      <a href="/technologies/x-carve-pro">
        <span class="xcp-navbar__xcp-logo--x-carve">X-CARVE </span>Pro
      </a>  </span>

      <span class="xcp-navbar__menu-button-and-cta">
        <span class="xcp-navbar__menu-button">
          <img src="https://d2rhdy377k7eul.cloudfront.net/assets/shared/chevron-thin-down-b23145d8ba5d6aa865fb1b83982b648ed16708190ebdd5704f1a18aa1f4606ce.svg">
        </span>
        <span class="xcp-navbar__menu-button hide">
          <img src="https://d2rhdy377k7eul.cloudfront.net/assets/shared/chevron-thin-up-49f9ae0663ff97639e6cd9cdcd2477220e5c81b70df5db6682f7ba86e41951b0.svg">
        </span>

        <a class="btn btn-primary xcp-navbar__order-now" href="/presales/choose-your-xcarve-pro">Order Now</a>
      </span>
  </nav>

  <ul class="xcp-navbar__menu hide">
    {%- if schedule_call_block -%}
      <li class="xcp-navbar__menu-item">
        <p>
          <a
            class="xcp-modal xcp-nav-schedule-a-call"
            data-target="calendly-modal-trigger"
            data-modal-target="xcp-demo__modal"
            data-modal-target-closed="xcp-demo__modal--closed"
            data-modal-closer="xcp-demo__modal-close">{{schedule_call_block.settings.label}}</a>
        </p>
      </li>
    {%- endif -%}
    {% for nav_item in nav_items %}
      <li class="xcp-navbar__menu-item">
        <p>
        <a href="{{nav_item.settings.href}}">{{nav_item.settings.label}}</a>
        </p>
      </li>
    {% endfor %}
  </ul>

</div>

<div class="xcp-demo__modal xcp-demo__modal--closed">
  <div id="calendly-inline-widget" class="xcp-demo__modal-content">
    <div class="xcp-demo__modal-close">
      <i class="fa fa-times"></i>
    </div>
  </div>
</div>

{% comment %}
Calendly Widget
{% endcomment %}
<script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js"></script>
<script type="text/javascript">
  Calendly.initInlineWidget({
    url: 'https://calendly.com/x-carve-pro-demo',
    parentElement: document.getElementById('calendly-inline-widget'),
    prefill: {},
    utm: {}
  });
</script>

{% comment %}
Custom Mobile Nav
{% endcomment %}
<script>
const menuButtons = document.querySelectorAll(".xcp-navbar__menu-button");
menuButtons.forEach(function(menuButton) {
  menuButton.addEventListener('click', function() {
    const menu = document.querySelector('.xcp-navbar__menu')
    menu.classList.toggle('hide');
  })
})

document.querySelectorAll('[data-target="calendly-modal-trigger"]').forEach(function(calendlyTrigger) {
  calendlyTrigger.addEventListener('click', function() {
    document.querySelector('.xcp-navbar__menu').classList.toggle('hide');
  });
});
</script>
{% schema %}
{
  "name": "xcp-navbar",
  "tag": "section",
  "class": "section",
  "settings": [
  ],
  "blocks": [
     {
       "name": "Nav Item",
       "type": "xcp-nav-item",
       "settings": [
         {
           "type": "text",
           "id": "label",
           "label": "Label"
         },
         {
           "type": "url",
           "id": "href",
           "label": "HRef"
         },
         {
           "type": "checkbox",
           "id": "selected",
           "label": "Selected",
           "default": false
         }
       ]
     },
     {
       "name": "Schedule a call",
       "type": "xcp-nav-schedule-a-call",
       "limit": 1,
       "settings": [
         {
           "type": "text",
           "id": "label",
           "label": "Label",
           "default": "Schedule a Call"
         }
       ]
     },
     {
       "name": "Order Now",
       "type": "xcp-nav-order-now",
       "limit": 1,
       "settings": [
         {
           "type": "text",
           "id": "label",
           "label": "Label",
           "default": "Order Now"
         }
       ]
     }
 ],
 "presets": [
    {
      "name": "XCPro Navbar"
    }
 ]
}
{% endschema %}
