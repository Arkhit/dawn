<div class="ml-base my-mega">
  <product-recommendations
    class="related-products block"
    data-url="{{ routes.product_recommendations_url }}?section_id={{ section.id }}&product_id={{ product.id }}"
  >
    {% if recommendations.performed and recommendations.products_count > 0 %}
      <div
        id="related-products-carousel"
        class="splide"
        aria-label="carousel with thumbnail"
      >
        <div class="relative flex justify-between mr-base items-center mb-base">
          <h1 class="text-t-md">Related products</h1>

          <div class="splide__arrows flex gap-base">
            {% render 'prev', class: 'splide__arrow splide__arrow--prev' %}
            {% render 'next', class: 'splide__arrow splide__arrow--next' %}
          </div>
        </div>

        <div class="relative">
          <div class="splide__track">
            <ul class="splide__list">
              {% for product in recommendations.products %}
                {% comment %}
                  {% if forloop.index != related_products.size %}
                    {% assign class = '!border-0' %}
                  {% endif %}
                {% endcomment %}

                <li class="splide__slide">
                  {% render 'product-card', product: product, class: '!border-0' %}
                </li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    {% endif %}
  </product-recommendations>
</div>

<script src="{{ 'splide.min.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'splide-related.js' | asset_url }}" defer="defer"></script>
