{% assign variants = product.variants %}

<h3>Currently under construction, we're very sorry!</h3>

{% if variants.size > 1 %}
  <div class="variant-swatches">
    {% for variant in variants %}
      {% assign primary_color = variant.metafields.custom.primarycolor %}
      {% assign secondary_color = variant.metafields.custom.secondarycolor %}

      {% if primary_color and secondary_color %}
        {{ primary_color | default: 'No primary color' }} / {{ secondary_color | default: 'No secondary color' }}

        <label for="variant-{{ variant.id }}" class="swatch-label">
          <input
            type="radio"
            name="{{ product_form_id }}[id]"
            id="variant-{{ variant.id }}"
            value="{{ variant.id }}"
            {% if variant.id == product.selected_or_first_available_variant.id %}
              checked
            {% endif %}
          >
          <div
            class="swatch"
            style="
              width: 30px;
              height: 30px;
              border-radius: 50%;
              background: linear-gradient(45deg, {{ primary_color }} 50%, {{ secondary_color }} 50%);
              border: 1px solid #ccc;
              cursor: pointer;
            "
          ></div>
        </label>
      {% endif %}
    {% endfor %}
  </div>

  <script>
    // JavaScript to update the variant when a swatch is clicked
    document.addEventListener('DOMContentLoaded', function () {
      const productForm = document.getElementById('{{ product_form_id }}');
      if (productForm) {
        const swatchInputs = productForm.querySelectorAll('.variant-swatches input[type="radio"]');
        swatchInputs.forEach((input) => {
          input.addEventListener('change', (event) => {
            productForm.submit();
          });
        });
      }
    });
  </script>

  <style>
    .variant-swatches {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .swatch-label {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      position: relative;
      width: 30px;
      height: 30px;
    }

    .swatch-label input[type='radio'] {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }

    .swatch {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      border: 1px solid #ccc;
      cursor: pointer;
    }
  </style>
{% endif %}
